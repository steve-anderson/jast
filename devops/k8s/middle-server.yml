apiVersion: v1
kind: Service
metadata:
  name: middle-server
  labels:
    app: middle-server
spec:
  ports:
  - port: 8080
    name: http
  selector:
    app: middle-server
  clusterIP: None
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: middle-server
  labels:
    app: middle-server
spec:
  selector:
    matchLabels:
      app: middle-server
  template:
    metadata:
      labels:
        app: middle-server
    spec:
      imagePullSecrets:
      - name: regcred
      containers:
      - name: middle-server
        image: dregistry.swahome.net:7443/research/jast/middle-server:1.0
        command: ["/opt/jboss/wildfly/bin/standalone.sh","--server-config=standalone-full.xml","-Djboss.node.name=middle-server","--debug","5000","-b","0.0.0.0","-bmanagement","0.0.0.0"]
        ports:
        - containerPort: 8080
          name: http
